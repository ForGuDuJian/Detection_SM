# Detection_SM
This repository includes the source code for yolo_SM.<br>
It is recommanded to use the ananconda and create the virtual environment for the model to detect spinal metastasis. The yolov5 folder can be refered for the environment configuration.<br>
## Installation
Trained and validated with Python3.8.<br>
PyTorch should be installed with the appropriate CUDA version for your hardware before installing requirements.txt.<br>

	$ conda create --name Detection_SM python=3.8
	$ conda install pytorch torchvision torchaudio pytorch-cuda=11.8 -c pytorch -c nvidia
	$ conda install --file requirements.txt -c pytorch
 ## Data preparation
The labels were generated by imaging annotation tools: [LabelImg](https://pypi.org/project/labelImg/)<br>
Label format:

	Class-number X-Center Y-Center X-Length Y-Length
Image and label files should have the same filename except for their extension (e.g. `img-00001.jpg` corresponds to label `img-00001.txt`).

Data yaml files can be modeled after `/data/xxx.yaml` and should be saved in the `/data/` folder. The images and text labels should be organized into folders as follows:

```
.
│  main_directory
│  
├─images
│  ├─train
│  │      img-00001-00001.jpg
│  │      ...
│  └─val
│          img-00200-00001.jpg
│          ...
└─labels
    ├─train
    │      img-00001-00001.txt
    │      ...
    └─val
            img-00200-00001.txt
            ...
```
## Train and inference
For training and inference with YOLOv5, please modify and run the `train.py` and `val.py`. The `YOLOv5_Detection_SM.ipynb` shows training and inference examples for YOLOv5.
